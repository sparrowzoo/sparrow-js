(self["webpackChunkSparrow_MOBILE_CHAT"]=self["webpackChunkSparrow_MOBILE_CHAT"]||[]).push([["src_components_Dialog_vue"],{"./src/components/Dialog.vue":
/*!***********************************!*\
  !*** ./src/components/Dialog.vue ***!
  \***********************************/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Dialog_vue_vue_type_template_id_cd1e8110_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Dialog.vue?vue&type=template&id=cd1e8110&scoped=true& */ "./src/components/Dialog.vue?vue&type=template&id=cd1e8110&scoped=true&");\n/* harmony import */ var _Dialog_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Dialog.vue?vue&type=script&lang=js& */ "./src/components/Dialog.vue?vue&type=script&lang=js&");\n/* harmony import */ var _Dialog_vue_vue_type_style_index_0_id_cd1e8110_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css& */ "./src/components/Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css&");\n/* harmony import */ var _node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! !../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js */ "./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js");\n\n\n\n;\n\n\n/* normalize component */\n\nvar component = (0,_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(\n  _Dialog_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],\n  _Dialog_vue_vue_type_template_id_cd1e8110_scoped_true___WEBPACK_IMPORTED_MODULE_0__.render,\n  _Dialog_vue_vue_type_template_id_cd1e8110_scoped_true___WEBPACK_IMPORTED_MODULE_0__.staticRenderFns,\n  false,\n  null,\n  "cd1e8110",\n  null\n  \n)\n\n/* hot reload */\nif (false) { var api; }\ncomponent.options.__file = "src/components/Dialog.vue"\n/* harmony default export */ __webpack_exports__["default"] = (component.exports);\n\n//# sourceURL=webpack://Sparrow-MOBILE-CHAT/./src/components/Dialog.vue?')},"./src/components/Dialog.vue?vue&type=script&lang=js&":
/*!************************************************************!*\
  !*** ./src/components/Dialog.vue?vue&type=script&lang=js& ***!
  \************************************************************/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Dialog.vue?vue&type=script&lang=js& */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=script&lang=js&");\n /* harmony default export */ __webpack_exports__["default"] = (_node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__["default"]); \n\n//# sourceURL=webpack://Sparrow-MOBILE-CHAT/./src/components/Dialog.vue?')},"./src/components/Dialog.vue?vue&type=template&id=cd1e8110&scoped=true&":
/*!******************************************************************************!*\
  !*** ./src/components/Dialog.vue?vue&type=template&id=cd1e8110&scoped=true& ***!
  \******************************************************************************/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "render": function() { return /* reexport safe */ _node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_template_id_cd1e8110_scoped_true___WEBPACK_IMPORTED_MODULE_0__.render; },\n/* harmony export */   "staticRenderFns": function() { return /* reexport safe */ _node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_template_id_cd1e8110_scoped_true___WEBPACK_IMPORTED_MODULE_0__.staticRenderFns; }\n/* harmony export */ });\n/* harmony import */ var _node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_template_id_cd1e8110_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Dialog.vue?vue&type=template&id=cd1e8110&scoped=true& */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=template&id=cd1e8110&scoped=true&");\n\n\n//# sourceURL=webpack://Sparrow-MOBILE-CHAT/./src/components/Dialog.vue?')},"./src/components/Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css&":
/*!********************************************************************************************!*\
  !*** ./src/components/Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css& ***!
  \********************************************************************************************/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _node_modules_vue_style_loader_index_js_clonedRuleSet_12_use_0_node_modules_css_loader_dist_cjs_js_clonedRuleSet_12_use_1_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_clonedRuleSet_12_use_2_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_style_index_0_id_cd1e8110_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../node_modules/vue-style-loader/index.js??clonedRuleSet-12.use[0]!../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css& */ "./node_modules/vue-style-loader/index.js??clonedRuleSet-12.use[0]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css&");\n/* harmony import */ var _node_modules_vue_style_loader_index_js_clonedRuleSet_12_use_0_node_modules_css_loader_dist_cjs_js_clonedRuleSet_12_use_1_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_clonedRuleSet_12_use_2_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_style_index_0_id_cd1e8110_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_clonedRuleSet_12_use_0_node_modules_css_loader_dist_cjs_js_clonedRuleSet_12_use_1_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_clonedRuleSet_12_use_2_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_style_index_0_id_cd1e8110_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _node_modules_vue_style_loader_index_js_clonedRuleSet_12_use_0_node_modules_css_loader_dist_cjs_js_clonedRuleSet_12_use_1_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_clonedRuleSet_12_use_2_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_style_index_0_id_cd1e8110_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== "default") __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _node_modules_vue_style_loader_index_js_clonedRuleSet_12_use_0_node_modules_css_loader_dist_cjs_js_clonedRuleSet_12_use_1_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_clonedRuleSet_12_use_2_node_modules_vue_cli_service_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_Dialog_vue_vue_type_style_index_0_id_cd1e8110_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n\n\n//# sourceURL=webpack://Sparrow-MOBILE-CHAT/./src/components/Dialog.vue?')},"../api/Chat.js":
/*!**********************!*\
  !*** ../api/Chat.js ***!
  \**********************/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "ChatApi": function() { return /* binding */ ChatApi; }\n/* harmony export */ });\n/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.push.js */ "./node_modules/core-js/modules/es.array.push.js");\n/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__);\n\nconst SPARROW_BASE_URL = "http://server.im.academyshow.net/chat/v2";\nconst CONSUMER_BASE_URL = "http://studyapi.academyshow.net";\nconsole.log(CONSUMER_BASE_URL);\nconsole.log(SPARROW_BASE_URL);\nvar tokenConfig = {};\ntokenConfig[SPARROW_BASE_URL] = {\n  "login-token": function () {\n    return localStorage.getItem("token");\n  }\n};\ntokenConfig[CONSUMER_BASE_URL] = {\n  "X-Sugar-Token": function () {\n    return localStorage.getItem("token");\n  }\n};\nSparrow.ajax.tokenConfig = tokenConfig;\nconst ChatApi = {\n  getSession: function () {\n    return Sparrow.http.syncPost(SPARROW_BASE_URL + "/sessions");\n  },\n  getUserId: async function () {\n    return await Sparrow.http.syncPost(SPARROW_BASE_URL + "/get-user-id");\n  },\n  getContacts: async function () {\n    return await Sparrow.http.syncPost(SPARROW_BASE_URL + "/contacts");\n  },\n  setRead: function (session, vue) {\n    const params = {\n      sessionKey: session.key\n    };\n    return Sparrow.http.syncPost(SPARROW_BASE_URL + "/session/read", params).then(res => {\n      session.lastReadTime = new Date();\n      vue.$initialization.assembleLastMessage(session);\n      vue.$initialization.resortSessions(vue);\n      return res.data;\n    }, err => {\n      console.log(err.message);\n    });\n  },\n  cancelMsg: async function (params) {\n    $.ajax.SUCCESS = 0;\n    return await Sparrow.http.syncPost(SPARROW_BASE_URL + "/cancel", params).then(res => {\n      return res.data;\n    }, err => {\n      console.log(err.message);\n    });\n  },\n  login: function (code, mobile, password) {\n    const params = {\n      code: code,\n      mobile: mobile,\n      password: password,\n      areaCode: ""\n    };\n    return Sparrow.http.syncPost(CONSUMER_BASE_URL + "/app/authMember/loginByCode", params, 200);\n  },\n  getUserByPhone: function (mobile) {\n    const params = "mobile=" + mobile;\n    return Sparrow.http.syncGet(CONSUMER_BASE_URL + "/app/message/userDetail?" + params, 200);\n  },\n  getUserById: async function (id, vue) {\n    if (vue.$userMap != null && vue.$userMap[id] != null) {\n      return vue.$userMap[id];\n    }\n    const params = "id=" + id;\n    return await Sparrow.http.syncGet(CONSUMER_BASE_URL + "/app/message/findById?" + params, 200).then(function (res) {\n      vue.$userMap[res.data.userId] = res.data;\n      vue.$contact.users.push(res.data);\n      return res.data;\n    });\n  },\n  //初始化session时调用\n  getUserMapByIds: async function (idArr, localUserCache) {\n    //如果idArr为空，直接返回空对象\n    if (!Array.isArray(idArr) || idArr.length === 0) {\n      return {};\n    }\n    var userId = -1;\n    var i = 0;\n    try {\n      var userResultMap = {};\n      var needRemoteFetchIdArr = [];\n      //先从本地缓存中获取,并且将本地缓存中没有的id放入needRemoteFetchIdArr\n      for (i = 0; i < idArr.length; i++) {\n        userId = idArr[i];\n        if (localUserCache[userId] != null) {\n          userResultMap[userId] = localUserCache[userId];\n        } else {\n          needRemoteFetchIdArr.push(userId);\n        }\n      }\n      //needRemoteFetchIdArr = [7, 69];\n      //如果本地缓存中已经包含了所有的id，则直接返回\n      if (needRemoteFetchIdArr.length === 0) {\n        return userResultMap;\n      }\n      //如果本地缓存中没有，则从远程获取\n      const remoteUsers = await Sparrow.http.syncPost(CONSUMER_BASE_URL + "/app/message/userDetailList", needRemoteFetchIdArr, 200).then(function (res) {\n        return res.data;\n      }, function (error) {\n        return {\n          error\n        };\n      });\n      if (remoteUsers == null || remoteUsers.length === 0) {\n        return userResultMap;\n      }\n      for (i = 0; i < remoteUsers.length; i++) {\n        userId = remoteUsers[i].id;\n        var user = remoteUsers[i];\n        user.platform = !!user.isCustomer;\n        //将远程获取的用户信息放入本地缓存\n        localUserCache[userId] = remoteUsers[i];\n        //将远程获取的用户信息放入返回结果\n        userResultMap[userId] = remoteUsers[i];\n      }\n      return userResultMap;\n    } catch (e) {\n      console.error(e);\n      return {};\n    }\n  },\n  addFriendById: function (id) {\n    const params = "id=" + id;\n    return Sparrow.http.syncPost(CONSUMER_BASE_URL + "/app/message/addFriend", params, 200);\n  },\n  removeFriend: function (id) {\n    const params = "id=" + id;\n    return Sparrow.http.syncPost(CONSUMER_BASE_URL + "/app/message/removeFriend", params, 200);\n  },\n  newFriendList: function (id) {\n    const params = "id=" + id;\n    return Sparrow.http.syncGet(CONSUMER_BASE_URL + "/app/message/newFriend?" + params, 200);\n  },\n  auditFriend: function (id, status) {\n    const params = "id=" + id + "&status=" + status;\n    return Sparrow.http.syncPost(CONSUMER_BASE_URL + "/app/message/userFriendAudit", params, 200);\n  },\n  existGroup: function (id) {\n    const params = "groupId=" + id;\n    return Sparrow.http.syncPost(CONSUMER_BASE_URL + "/app/message/quitGroup", params, 200);\n  },\n  modifyGroup: function (id, name, avatar) {\n    const params = "groupId=" + id + "&name=" + name + "&avatar=" + avatar;\n    return Sparrow.http.syncPost(CONSUMER_BASE_URL + "/app/message/changeGroup", params, 200);\n  },\n  systemNotice: function () {\n    return Sparrow.http.syncGet(CONSUMER_BASE_URL + "/app/message/systemInform", 200);\n  },\n  platformServices: function () {\n    return Sparrow.http.syncGet(CONSUMER_BASE_URL + "/app/message/customList", 200);\n  }\n};\n\n\n//# sourceURL=webpack://Sparrow-MOBILE-CHAT/../api/Chat.js?')},"./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=script&lang=js&":
/*!********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=script&lang=js& ***!
  \********************************************************************************************************************************************************************************************************************************/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.push.js */ "./node_modules/core-js/modules/es.array.push.js");\n/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var core_js_modules_esnext_typed_array_to_reversed_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/esnext.typed-array.to-reversed.js */ "./node_modules/core-js/modules/esnext.typed-array.to-reversed.js");\n/* harmony import */ var core_js_modules_esnext_typed_array_to_reversed_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_esnext_typed_array_to_reversed_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var core_js_modules_esnext_typed_array_to_sorted_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/esnext.typed-array.to-sorted.js */ "./node_modules/core-js/modules/esnext.typed-array.to-sorted.js");\n/* harmony import */ var core_js_modules_esnext_typed_array_to_sorted_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_esnext_typed_array_to_sorted_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var core_js_modules_esnext_typed_array_with_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! core-js/modules/esnext.typed-array.with.js */ "./node_modules/core-js/modules/esnext.typed-array.with.js");\n/* harmony import */ var core_js_modules_esnext_typed_array_with_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_esnext_typed_array_with_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var vant__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! vant */ "./node_modules/vant/es/dialog/index.js");\n/* harmony import */ var vant__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! vant */ "./node_modules/vant/es/toast/index.js");\n/* harmony import */ var _api_Chat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../api/Chat */ "../api/Chat.js");\n/* harmony import */ var _source_scripts_ImProtocol__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../source/scripts/ImProtocol */ "../../source/scripts/ImProtocol.js");\n/* harmony import */ var _api_Initialization__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../api/Initialization */ "../api/Initialization.js");\n\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__["default"] = ({\n  name: "ChatDialog",\n  data() {\n    return {\n      activeSession: {\n        key: -1,\n        messages: [],\n        title: "",\n        chatType: -1\n      },\n      content: "",\n      messageList: [],\n      interval: null\n    };\n  },\n  directives: {\n    longpress: {\n      bind(el, binding) {\n        let timer;\n        const start = () => {\n          timer = setTimeout(() => {\n            if (binding.value) {\n              binding.value();\n            }\n          }, 800);\n        };\n        const stop = () => {\n          if (timer) {\n            clearTimeout(timer);\n          }\n        };\n        el.addEventListener("touchstart", e => {\n          console.log("touch start");\n          e.preventDefault();\n          stop();\n          start();\n        });\n        // el.addEventListener("touchmove", (e) => {\n        //     stop()\n        // })\n        el.addEventListener("touchend", e => {\n          e.preventDefault();\n          stop();\n        });\n      }\n    }\n  },\n  async mounted() {\n    this.handleScrollBottom();\n    _api_Initialization__WEBPACK_IMPORTED_MODULE_6__.Initialization.initActiveSession(this);\n    this.read();\n    console.log("first load");\n    var that = this;\n    document.onkeydown = function (e) {\n      let key = e.keyCode;\n      if (key !== 13) return;\n      that.sendText();\n    };\n    _api_Initialization__WEBPACK_IMPORTED_MODULE_6__.Initialization.toBottom = function () {\n      that.handleScrollBottom();\n    };\n  },\n  computed: {},\n  // beforeCreate() {\n  //   console.log("beforeCreate");\n  // },\n  // created() {\n  //   console.log("created");\n  // },\n  // async beforeMount() {\n  //   console.log("beforeMount");\n  // },\n  // beforeUpdate() {\n  //   console.log("beforeUpdate");\n  // },\n  // updated() {\n  //   console.log("updated");\n  // },\n  //\n  // destroyed() {\n  //   console.log("destroyed");\n  // },\n  // activated() {\n  //   console.log("activated");\n  // },\n  // deactivated() {\n  //   console.log("deactivated");\n  // },\n  // errorCaptured() {\n  //   console.log("errorCaptured");\n  // },\n  //\n  // beforeDestroy() {\n  //   console.log("beforeDestroy");\n  // },\n  /**\n   * Vue生命周期函数有：\n   * beforeCreate、\n   * created、\n   * beforeMount、\n   * mounted、\n   * beforeUpdate、\n   * updated、\n   * beforeDestroy、\n   * destroyed、\n   * activated、\n   * deactivated、\n   * errorCaptured。\n   *\n   * 1、beforeCreate：组件实例刚被创建，组件属性计算之前。\n   *\n   * 2、Created：组件实例刚被创建，属性已绑定，但DOM还未生成。\n   *\n   * 3、beforeMount：模板编译/挂载之前。\n   *\n   * 4、Mounted：模板编译/挂载之后。\n   *\n   * 5、beforeUpdate：组件更新之前。\n   *\n   * 6、Updated：组件更新之后。\n   *\n   * 7、beforeDestroy：组件销毁前调用。\n   *\n   * 8、Destroyed：组件销毁后调用。\n   *\n   * 9、activated：组件激活时调用。\n   *\n   * 10、deactivated：组件停用时调用。\n   *\n   * 11、errorCaptured：当捕获一个来自子孙组件的错误时被调用。\n   */\n  methods: {\n    goBack() {\n      this.$router.push("contact");\n    },\n    qunDetail() {\n      this.$router.push({\n        name: "qunDetail",\n        query: {\n          key: this.$route.query.key\n        }\n      });\n    },\n    async cancel(item) {\n      console.log(item);\n      var currentUserId = this.$getUserId();\n      if (item.sender !== currentUserId) {\n        return;\n      }\n      vant__WEBPACK_IMPORTED_MODULE_7__["default"].confirm({\n        title: "消息撤回",\n        message: "请确认是否撤销消息"\n      }).then(async () => {\n        console.log("cancel", item);\n        const param = {\n          sender: currentUserId,\n          token: this.$token,\n          clientSendTime: item.clientSendTime,\n          sessionKey: item.session,\n          chatType: item.chatType\n        };\n        console.log(param);\n        var result = await _api_Chat__WEBPACK_IMPORTED_MODULE_4__.ChatApi.cancelMsg(param);\n        if (result === true) {\n          var session = this.$sessionMap[param.sessionKey];\n          session.messages = session.messages.filter(message => message.clientSendTime !== item.clientSendTime);\n        }\n      }).catch(() => {\n        // on cancel\n      });\n    },\n    read() {\n      _api_Chat__WEBPACK_IMPORTED_MODULE_4__.ChatApi.setRead(this.activeSession, this);\n    },\n    // 滚动到底部\n    handleScrollBottom() {\n      //页面渲染完毕后执行\n\n      this.$nextTick(() => {\n        let scrollElem = this.$refs.scrollDiv;\n        console.log("next tick:", scrollElem);\n        if (scrollElem) {\n          window.scrollTo(0, scrollElem.scrollHeight);\n        }\n      });\n    },\n    async sendImage(file) {\n      const fileReader = new FileReader();\n      var that = this;\n      fileReader.onload = function () {\n        const result = fileReader.result;\n        var content = new Uint8Array(result);\n        if (content.byteLength >= 1024 * 1024 * 3) {\n          vant__WEBPACK_IMPORTED_MODULE_8__["default"].fail("图片大小不能超过3M");\n          return;\n        }\n        var time = new Date().getTime();\n        var chatType = parseInt(that.activeSession.type, 10);\n        //如果是1对1聊天\n        var oppositeUserId = _source_scripts_ImProtocol__WEBPACK_IMPORTED_MODULE_5__.ImProtocol.getOppositeUser(that);\n        var protocol = new that.$protocol(chatType, that.$protocol.IMAGE_MESSAGE, that.$getUserId(), oppositeUserId, that.$route.query.key, content, time);\n        that.$webSocket.sendMessage(protocol);\n        this.content = "";\n        _api_Initialization__WEBPACK_IMPORTED_MODULE_6__.Initialization.setSessionLastReadTime(that.activeSession);\n        _api_Initialization__WEBPACK_IMPORTED_MODULE_6__.Initialization.rebuild(protocol, that);\n        that.handleScrollBottom();\n        console.log("parse protocol:" + protocol);\n      };\n      fileReader.readAsArrayBuffer(file.file);\n    },\n    sendText() {\n      if (!this.content) {\n        vant__WEBPACK_IMPORTED_MODULE_8__["default"].fail("嘿！你还没有输入内容哦！");\n        return;\n      }\n      var time = new Date().getTime();\n      var chatType = parseInt(this.activeSession.type, 10);\n      //如果是1对1聊天\n      var oppositeUserId = this.$route.query.targetUserId;\n      if (oppositeUserId != null) {\n        oppositeUserId = parseInt(oppositeUserId, 10);\n      } else {\n        oppositeUserId = _source_scripts_ImProtocol__WEBPACK_IMPORTED_MODULE_5__.ImProtocol.getOppositeUser(this);\n      }\n      var protocol = new _source_scripts_ImProtocol__WEBPACK_IMPORTED_MODULE_5__.ImProtocol(chatType, _source_scripts_ImProtocol__WEBPACK_IMPORTED_MODULE_5__.ImProtocol.TEXT_MESSAGE, this.$getUserId(), oppositeUserId, this.$route.query.key, this.content, time);\n      this.$webSocket.sendMessage(protocol);\n      this.content = "";\n      _api_Initialization__WEBPACK_IMPORTED_MODULE_6__.Initialization.setSessionLastReadTime(this.activeSession);\n      _api_Initialization__WEBPACK_IMPORTED_MODULE_6__.Initialization.rebuild(protocol, this);\n      console.log("parse protocol:" + protocol);\n      this.handleScrollBottom();\n    }\n  }\n});\n\n//# sourceURL=webpack://Sparrow-MOBILE-CHAT/./src/components/Dialog.vue?./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use%5B0%5D!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options')},"./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=template&id=cd1e8110&scoped=true&":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=template&id=cd1e8110&scoped=true& ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "render": function() { return /* binding */ render; },\n/* harmony export */   "staticRenderFns": function() { return /* binding */ staticRenderFns; }\n/* harmony export */ });\nvar render = function render() {\n  var _vm = this,\n    _c = _vm._self._c;\n  return _c("div", {\n    staticClass: "chat"\n  }, [_c("van-nav-bar", {\n    attrs: {\n      fixed: true,\n      title: _vm.activeSession.title,\n      "left-arrow": ""\n    },\n    on: {\n      "click-left": _vm.goBack\n    },\n    scopedSlots: _vm._u([_vm.activeSession.type === this.$protocol.CHAT_TYPE_1_2_N ? {\n      key: "right",\n      fn: function () {\n        return [_c("van-icon", {\n          attrs: {\n            name: "ellipsis",\n            size: "1.5rem"\n          },\n          on: {\n            click: function ($event) {\n              return _vm.qunDetail();\n            }\n          }\n        })];\n      },\n      proxy: true\n    } : null], null, true)\n  }), _c("div", {\n    ref: "scrollDiv",\n    staticClass: "center"\n  }, _vm._l(this.activeSession.messages, function (message) {\n    return _c("div", {\n      key: message.id,\n      staticClass: "chat"\n    }, [_c("div", {\n      staticClass: "time"\n    }, [_vm._v(_vm._s(message.time))]), _c("div", {\n      class: message.isMe ? "right" : "left"\n    }, [_c("img", {\n      staticClass: "avatar",\n      attrs: {\n        src: message.avatar\n      }\n    }), _c("div", {\n      staticClass: "content_wrap"\n    }, [_c("div", {\n      staticClass: "user_name"\n    }, [_vm._v(" " + _vm._s(message.userName) + " ")]), message.isText ? _c("div", {\n      staticClass: "content"\n    }, [message.isMe ? _c("div", {\n      directives: [{\n        name: "longpress",\n        rawName: "v-longpress",\n        value: () => _vm.cancel(message),\n        expression: "() => cancel(message)"\n      }]\n    }, [_vm._v(" " + _vm._s(message.content) + " ")]) : _c("div", [_vm._v(" " + _vm._s(message.content) + " ")])]) : _c("img", {\n      directives: [{\n        name: "longpress",\n        rawName: "v-longpress",\n        value: () => _vm.cancel(message),\n        expression: "() => cancel(message)"\n      }],\n      staticClass: "img",\n      attrs: {\n        src: message.imgUrl\n      }\n    })])])]);\n  }), 0), _c("van-tabbar", {\n    staticClass: "bar",\n    attrs: {\n      fixed: true\n    }\n  }, [_c("van-uploader", {\n    staticClass: "send_img",\n    attrs: {\n      "after-read": _vm.sendImage\n    }\n  }, [_c("van-icon", {\n    attrs: {\n      name: "smile",\n      size: "2rem"\n    }\n  })], 1), _c("van-field", {\n    staticClass: "send_content",\n    attrs: {\n      autosize: {\n        maxHeight: 80\n      },\n      placeholder: "",\n      rows: "1",\n      type: "textarea"\n    },\n    model: {\n      value: _vm.content,\n      callback: function ($$v) {\n        _vm.content = $$v;\n      },\n      expression: "content"\n    }\n  }), _c("van-button", {\n    staticClass: "send",\n    attrs: {\n      size: "small",\n      type: "primary"\n    },\n    on: {\n      click: function ($event) {\n        return _vm.sendText();\n      }\n    }\n  }, [_vm._v("发送 ")])], 1)], 1);\n};\nvar staticRenderFns = [];\nrender._withStripped = true;\n\n\n//# sourceURL=webpack://Sparrow-MOBILE-CHAT/./src/components/Dialog.vue?./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use%5B0%5D!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet%5B1%5D.rules%5B3%5D!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options')},"./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css&":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../node_modules/css-loader/dist/runtime/noSourceMaps.js */ "./node_modules/css-loader/dist/runtime/noSourceMaps.js");\n/* harmony import */ var _node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_noSourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, "\\n.chat[data-v-cd1e8110] {\\n  height: 100%;\\n  display: flex;\\n  flex-direction: column;\\n}\\n.bar[data-v-cd1e8110] {\\n  display: flex;\\n  background-color: #fff;\\n}\\n.center[data-v-cd1e8110] {\\n  /*flex: 1 0 0;*/\\n  background-color: #f7f7f7;\\n  padding: 0 1rem 1rem;\\n  overflow-y: scroll;\\n  height: 100%;\\n  margin-top: 2.5rem;\\n}\\n.avatar[data-v-cd1e8110] {\\n  width: 3rem;\\n  height: 3rem;\\n  background: #f2f3f5;\\n  border-radius: 4px;\\n  display: block;\\n}\\n.time[data-v-cd1e8110] {\\n  text-align: center;\\n  color: #555;\\n  margin-top: 0.5rem;\\n}\\n.right[data-v-cd1e8110] {\\n  flex-direction: row-reverse;\\n  display: flex;\\n  margin-top: 0.5rem;\\n}\\n.left[data-v-cd1e8110] {\\n  flex-direction: row;\\n  display: flex;\\n  margin-top: 0.5rem;\\n}\\n.content_wrap[data-v-cd1e8110] {\\n  flex: 1 0 0;\\n  width: 0;\\n  background: #fff;\\n}\\n.right .content_wrap[data-v-cd1e8110] {\\n  margin-right: 1rem;\\n  text-align: right;\\n}\\n.left .content_wrap[data-v-cd1e8110] {\\n  margin-left: 1rem;\\n}\\n.right .user_name[data-v-cd1e8110] {\\n  text-align: right;\\n  margin-bottom: 0.1rem;\\n}\\n.content div[data-v-cd1e8110] {\\n  background-color: white;\\n  padding: 0.5rem 1rem;\\n  border-radius: 4px;\\n  white-space: pre-wrap;\\n  word-break: break-all;\\n}\\n.right .content[data-v-cd1e8110] {\\n  flex-direction: row-reverse;\\n  flex: 1 0 0;\\n}\\n.left .content[data-v-cd1e8110] {\\n  flex-direction: row;\\n  flex: 1 0 0;\\n}\\n.img[data-v-cd1e8110] {\\n  max-width: 10rem;\\n  max-height: 10rem;\\n  /* margin-left: 1rem; */\\n  /* margin-right: 1rem; */\\n}\\n.send[data-v-cd1e8110] {\\n  width: 4rem;\\n  margin: 10px 10px 0 10px;\\n}\\n.send_content[data-v-cd1e8110] {\\n  border: 1px solid #f9f9f9;\\n  height: 2.5rem;\\n  flex: 1;\\n  margin: 5px 10px 0 0;\\n  border-radius: 4px;\\n}\\n.send_img[data-v-cd1e8110] {\\n  height: 2.5rem;\\n  margin: 10px;\\n}\\n", ""]);\n// Exports\n/* harmony default export */ __webpack_exports__["default"] = (___CSS_LOADER_EXPORT___);\n\n\n//# sourceURL=webpack://Sparrow-MOBILE-CHAT/./src/components/Dialog.vue?./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use%5B1%5D!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use%5B2%5D!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options')},"./node_modules/vue-style-loader/index.js??clonedRuleSet-12.use[0]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css&":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-style-loader/index.js??clonedRuleSet-12.use[0]!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/function(module,__unused_webpack_exports,__webpack_require__){eval('// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(/*! !!../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css& */ "./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use[1]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use[2]!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Dialog.vue?vue&type=style&index=0&id=cd1e8110&scoped=true&lang=css&");\nif(content.__esModule) content = content.default;\nif(typeof content === \'string\') content = [[module.id, content, \'\']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = (__webpack_require__(/*! !../../node_modules/vue-style-loader/lib/addStylesClient.js */ "./node_modules/vue-style-loader/lib/addStylesClient.js")["default"])\nvar update = add("e47f217c", content, false, {"sourceMap":false,"shadowMode":false});\n// Hot Module Replacement\nif(false) {}\n\n//# sourceURL=webpack://Sparrow-MOBILE-CHAT/./src/components/Dialog.vue?./node_modules/vue-style-loader/index.js??clonedRuleSet-12.use%5B0%5D!./node_modules/css-loader/dist/cjs.js??clonedRuleSet-12.use%5B1%5D!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-12.use%5B2%5D!./node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options')}}]);