"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/cros/page",{

/***/ "(app-pages-browser)/./src/common/lib/CrosStorage.ts":
/*!***************************************!*\
  !*** ./src/common/lib/CrosStorage.ts ***!
  \***************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ CrosStorage; }\n/* harmony export */ });\n/* harmony import */ var _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/common/lib/protocol/CrosProtocol */ \"(app-pages-browser)/./src/common/lib/protocol/CrosProtocol.ts\");\n/* harmony import */ var _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/common/lib/Env */ \"(app-pages-browser)/./src/common/lib/Env.ts\");\n\n\nclass CrosStorage {\n    randomUUID() {\n        const hex = \"0123456789abcdef\";\n        let uuid = \"\";\n        for(let i = 0; i < 36; i++){\n            if ([\n                8,\n                13,\n                18,\n                23\n            ].includes(i)) uuid += \"-\";\n            else uuid += hex[Math.floor(Math.random() * 16)];\n        }\n        return uuid;\n    }\n    static getCurrentStorage() {\n        return new CrosStorage(false);\n    }\n    static getCrosStorage() {\n        return new CrosStorage();\n    }\n    set(value) {\n        let key = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.TOKEN_KEY, storage = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.AUTOMATIC;\n        storage = this.getStorageType(storage);\n        if (!this.cros) {\n            const store = storage === _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.LOCAL ? localStorage : sessionStorage;\n            store.setItem(key, value);\n            return Promise.resolve(value);\n        }\n        return this.request({\n            requestId: this.randomUUID(),\n            command: _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.CommandType.SET,\n            storage: storage,\n            key,\n            value\n        });\n    }\n    get() {\n        let key = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.TOKEN_KEY, storage = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.AUTOMATIC;\n        storage = this.getStorageType(storage);\n        if (!this.cros) {\n            const store = storage === \"local\" ? localStorage : sessionStorage;\n            return Promise.resolve(store.getItem(key));\n        }\n        return this.request({\n            requestId: this.randomUUID(),\n            command: _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.CommandType.GET,\n            storage: storage,\n            key\n        });\n    }\n    remove() {\n        let key = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.TOKEN_KEY, storage = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.AUTOMATIC;\n        storage = this.getStorageType(storage);\n        if (!this.cros) {\n            const store = storage === _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.LOCAL ? localStorage : sessionStorage;\n            const value = store.getItem(key);\n            store.removeItem(key);\n            return Promise.resolve(value);\n        }\n        return this.request({\n            requestId: this.randomUUID(),\n            command: _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.CommandType.REMOVE,\n            storage: storage,\n            key\n        });\n    }\n    destroy() {\n        document.body.removeChild(this.iframe);\n    }\n    async getToken() {\n        let storage = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.AUTOMATIC, generateVisitorToken = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : null;\n        const token = await this.get(_common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.TOKEN_KEY, storage);\n        if (token) {\n            return token;\n        }\n        if (generateVisitorToken) {\n            debugger;\n            const visitorToken = await generateVisitorToken();\n            await this.setToken(visitorToken);\n            return visitorToken;\n        }\n        return null;\n    }\n    setToken(token) {\n        let storage = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.AUTOMATIC;\n        return this.set(token, _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.TOKEN_KEY, storage);\n    }\n    removeToken() {\n        let storage = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.AUTOMATIC;\n        return this.remove(_common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.TOKEN_KEY, storage);\n    }\n    getStorageType(storageType) {\n        if (storageType === _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.AUTOMATIC) {\n            storageType = _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.TOKEN_STORAGE === \"SESSION\" ? _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.SESSION : _common_lib_protocol_CrosProtocol__WEBPACK_IMPORTED_MODULE_0__.StorageType.LOCAL;\n        }\n        return storageType;\n    }\n    // 发送请求\n    request(req) {\n        return new Promise((resolve, reject)=>{\n            // 监听响应\n            const handleMessage = (event)=>{\n                var _this_iframeOrigin, _this;\n                if (!this.iframeOrigin || ((_this = this) === null || _this === void 0 ? void 0 : (_this_iframeOrigin = _this.iframeOrigin) === null || _this_iframeOrigin === void 0 ? void 0 : _this_iframeOrigin.indexOf(event.origin)) < 0 || event.data.requestId !== req.requestId) return;\n                window.removeEventListener(\"message\", handleMessage); // 清理监听\n                if (event.data.error) {\n                    reject(new Error(event.data.error));\n                } else {\n                    resolve(event.data.value);\n                }\n            };\n            window.addEventListener(\"message\", handleMessage);\n            const send = ()=>{\n                console.log(\"send request\", this.loaded);\n                if (!this.loaded) {\n                    setTimeout(send, 1000);\n                    return;\n                }\n                try {\n                    var _this_iframe_contentWindow;\n                    (_this_iframe_contentWindow = this.iframe.contentWindow) === null || _this_iframe_contentWindow === void 0 ? void 0 : _this_iframe_contentWindow.postMessage(req, this.iframeOrigin);\n                } catch (e) {\n                    setTimeout(send, 1000);\n                }\n            };\n            send();\n        // 超时处理\n        // setTimeout(() => {\n        //   window.removeEventListener(\"message\", handleMessage);\n        //   reject(new Error(\"Request timeout\"));\n        // }, 5000);\n        });\n    }\n    constructor(cros = null){\n        this.cros = false;\n        this.loaded = false;\n        if (cros === false) {\n            return;\n        }\n        this.cros = _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.STORAGE_PROXY ? true : false;\n        if (this.cros == false) {\n            return;\n        }\n        const iframe = document.createElement(\"iframe\");\n        iframe.src = _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.STORAGE_PROXY;\n        iframe.style.display = \"none\";\n        this.iframe = iframe;\n        console.log(\"append iframe \" + _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.STORAGE_PROXY);\n        iframe.addEventListener(\"DOMContentLoaded\", ()=>{\n            console.log(\"iframe DOMContentLoaded\");\n            this.loaded = true;\n        });\n        iframe.addEventListener(\"load\", ()=>{\n            console.log(\"iframe loaded\");\n            this.loaded = true;\n        });\n        document.body.appendChild(iframe);\n        this.iframeOrigin = _common_lib_Env__WEBPACK_IMPORTED_MODULE_1__.STORAGE_PROXY;\n    }\n}\n\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb21tb24vbGliL0Nyb3NTdG9yYWdlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUs0QztBQUMrQjtBQUU1RCxNQUFNSztJQU1YQyxhQUFhO1FBQ25CLE1BQU1DLE1BQU07UUFDWixJQUFJQyxPQUFPO1FBQ1gsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUksSUFBSUEsSUFBSztZQUMzQixJQUFJO2dCQUFDO2dCQUFHO2dCQUFJO2dCQUFJO2FBQUcsQ0FBQ0MsUUFBUSxDQUFDRCxJQUFJRCxRQUFRO2lCQUNwQ0EsUUFBUUQsR0FBRyxDQUFDSSxLQUFLQyxLQUFLLENBQUNELEtBQUtFLE1BQU0sS0FBSyxJQUFJO1FBQ2xEO1FBQ0EsT0FBT0w7SUFDVDtJQTJCQSxPQUFjTSxvQkFBb0I7UUFDaEMsT0FBTyxJQUFJVCxZQUFZO0lBQ3pCO0lBRUEsT0FBY1UsaUJBQWlCO1FBQzdCLE9BQU8sSUFBSVY7SUFDYjtJQUVPVyxJQUNMQyxLQUFhLEVBR2I7WUFGQUMsTUFBQUEsaUVBQWNmLHNEQUFTQSxFQUN2QmdCLFVBQUFBLGlFQUF1QmxCLDBFQUFXQSxDQUFDbUIsU0FBUztRQUU1Q0QsVUFBVSxJQUFJLENBQUNFLGNBQWMsQ0FBQ0Y7UUFDOUIsSUFBSSxDQUFDLElBQUksQ0FBQ0csSUFBSSxFQUFFO1lBQ2QsTUFBTUMsUUFDSkosWUFBWWxCLDBFQUFXQSxDQUFDdUIsS0FBSyxHQUFHQyxlQUFlQztZQUNqREgsTUFBTUksT0FBTyxDQUFDVCxLQUFLRDtZQUNuQixPQUFPVyxRQUFRQyxPQUFPLENBQUNaO1FBQ3pCO1FBRUEsT0FBTyxJQUFJLENBQUNhLE9BQU8sQ0FBQztZQUNsQkMsV0FBVyxJQUFJLENBQUN6QixVQUFVO1lBQzFCMEIsU0FBU2hDLDBFQUFXQSxDQUFDaUMsR0FBRztZQUN4QmQsU0FBU0E7WUFDVEQ7WUFDQUQ7UUFDRjtJQUNGO0lBRU9pQixNQUdMO1lBRkFoQixNQUFBQSxpRUFBY2Ysc0RBQVNBLEVBQ3ZCZ0Is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QUMsbUJBQW1CbEUsMERBQWFBO1FBQzVDMEMsT0FBT3FCLGdCQUFnQixDQUFDLG9CQUFvQjtZQUMxQ0UsUUFBUUMsR0FBRyxDQUFDO1lBQ1osSUFBSSxDQUFDQyxNQUFNLEdBQUc7UUFDaEI7UUFDQXpCLE9BQU9xQixnQkFBZ0IsQ0FBQyxRQUFRO1lBQzlCRSxRQUFRQyxHQUFHLENBQUM7WUFDWixJQUFJLENBQUNDLE1BQU0sR0FBRztRQUNoQjtRQUNBNUIsU0FBU0MsSUFBSSxDQUFDb0MsV0FBVyxDQUFDbEM7UUFDMUIsSUFBSSxDQUFDYSxZQUFZLEdBQUd2RCwwREFBYUE7SUFDbkM7QUF3SkY7QUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvY29tbW9uL2xpYi9Dcm9zU3RvcmFnZS50cz8wNmExIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbW1hbmRUeXBlLFxuICBTdG9yYWdlUmVxdWVzdCxcbiAgU3RvcmFnZVJlc3BvbnNlLFxuICBTdG9yYWdlVHlwZSxcbn0gZnJvbSBcIkAvY29tbW9uL2xpYi9wcm90b2NvbC9Dcm9zUHJvdG9jb2xcIjtcbmltcG9ydCB7IFNUT1JBR0VfUFJPWFksIFRPS0VOX0tFWSwgVE9LRU5fU1RPUkFHRSB9IGZyb20gXCJAL2NvbW1vbi9saWIvRW52XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENyb3NTdG9yYWdlIHtcbiAgcHJpdmF0ZSBpZnJhbWU6IEhUTUxJRnJhbWVFbGVtZW50O1xuICBwcml2YXRlIGlmcmFtZU9yaWdpbjogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBwcml2YXRlIGNyb3M6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBsb2FkZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcml2YXRlIHJhbmRvbVVVSUQoKSB7XG4gICAgY29uc3QgaGV4ID0gJzAxMjM0NTY3ODlhYmNkZWYnO1xuICAgIGxldCB1dWlkID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzNjsgaSsrKSB7XG4gICAgICBpZiAoWzgsIDEzLCAxOCwgMjNdLmluY2x1ZGVzKGkpKSB1dWlkICs9ICctJztcbiAgICAgIGVsc2UgdXVpZCArPSBoZXhbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTYpXTtcbiAgICB9XG4gICAgcmV0dXJuIHV1aWQ7XG4gIH1cblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKGNyb3M6IEJvb2xlYW4gfCBudWxsID0gbnVsbCkge1xuICAgIGlmIChjcm9zID09PSBmYWxzZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmNyb3MgPSBTVE9SQUdFX1BST1hZID8gdHJ1ZSA6IGZhbHNlO1xuICAgIGlmICh0aGlzLmNyb3MgPT0gZmFsc2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKTtcbiAgICBpZnJhbWUuc3JjID0gU1RPUkFHRV9QUk9YWSBhcyBzdHJpbmc7XG4gICAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICB0aGlzLmlmcmFtZSA9IGlmcmFtZTtcbiAgICBjb25zb2xlLmxvZyhcImFwcGVuZCBpZnJhbWUgXCIgKyBTVE9SQUdFX1BST1hZKTtcbiAgICBpZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJpZnJhbWUgRE9NQ29udGVudExvYWRlZFwiKTtcbiAgICAgIHRoaXMubG9hZGVkID0gdHJ1ZTtcbiAgICB9KTtcbiAgICBpZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJpZnJhbWUgbG9hZGVkXCIpO1xuICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcbiAgICB0aGlzLmlmcmFtZU9yaWdpbiA9IFNUT1JBR0VfUFJPWFk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGdldEN1cnJlbnRTdG9yYWdlKCkge1xuICAgIHJldHVybiBuZXcgQ3Jvc1N0b3JhZ2UoZmFsc2UpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBnZXRDcm9zU3RvcmFnZSgpIHtcbiAgICByZXR1cm4gbmV3IENyb3NTdG9yYWdlKCk7XG4gIH1cblxuICBwdWJsaWMgc2V0KFxuICAgIHZhbHVlOiBzdHJpbmcsXG4gICAga2V5OiBzdHJpbmcgPSBUT0tFTl9LRVksXG4gICAgc3RvcmFnZTogU3RvcmFnZVR5cGUgPSBTdG9yYWdlVHlwZS5BVVRPTUFUSUNcbiAgKSB7XG4gICAgc3RvcmFnZSA9IHRoaXMuZ2V0U3RvcmFnZVR5cGUoc3RvcmFnZSk7XG4gICAgaWYgKCF0aGlzLmNyb3MpIHtcbiAgICAgIGNvbnN0IHN0b3JlID1cbiAgICAgICAgc3RvcmFnZSA9PT0gU3RvcmFnZVR5cGUuTE9DQUwgPyBsb2NhbFN0b3JhZ2UgOiBzZXNzaW9uU3RvcmFnZTtcbiAgICAgIHN0b3JlLnNldEl0ZW0oa2V5LCB2YWx1ZSk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbHVlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHtcbiAgICAgIHJlcXVlc3RJZDogdGhpcy5yYW5kb21VVUlEKCksXG4gICAgICBjb21tYW5kOiBDb21tYW5kVHlwZS5TRVQsXG4gICAgICBzdG9yYWdlOiBzdG9yYWdlLFxuICAgICAga2V5LFxuICAgICAgdmFsdWUsXG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgZ2V0KFxuICAgIGtleTogc3RyaW5nID0gVE9LRU5fS0VZLFxuICAgIHN0b3JhZ2U6IFN0b3JhZ2VUeXBlID0gU3RvcmFnZVR5cGUuQVVUT01BVElDXG4gICkge1xuICAgIHN0b3JhZ2UgPSB0aGlzLmdldFN0b3JhZ2VUeXBlKHN0b3JhZ2UpO1xuICAgIGlmICghdGhpcy5jcm9zKSB7XG4gICAgICBjb25zdCBzdG9yZSA9IHN0b3JhZ2UgPT09IFwibG9jYWxcIiA/IGxvY2FsU3RvcmFnZSA6IHNlc3Npb25TdG9yYWdlO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShzdG9yZS5nZXRJdGVtKGtleSkpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHtcbiAgICAgIHJlcXVlc3RJZDogdGhpcy5yYW5kb21VVUlEKCksXG4gICAgICBjb21tYW5kOiBDb21tYW5kVHlwZS5HRVQsXG4gICAgICBzdG9yYWdlOiBzdG9yYWdlLFxuICAgICAga2V5LFxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIHJlbW92ZShcbiAgICBrZXk6IHN0cmluZyA9IFRPS0VOX0tFWSxcbiAgICBzdG9yYWdlOiBTdG9yYWdlVHlwZSA9IFN0b3JhZ2VUeXBlLkFVVE9NQVRJQ1xuICApIHtcbiAgICBzdG9yYWdlID0gdGhpcy5nZXRTdG9yYWdlVHlwZShzdG9yYWdlKTtcbiAgICBpZiAoIXRoaXMuY3Jvcykge1xuICAgICAgY29uc3Qgc3RvcmUgPVxuICAgICAgICBzdG9yYWdlID09PSBTdG9yYWdlVHlwZS5MT0NBTCA/IGxvY2FsU3RvcmFnZSA6IHNlc3Npb25TdG9yYWdlO1xuICAgICAgY29uc3QgdmFsdWUgPSBzdG9yZS5nZXRJdGVtKGtleSk7XG4gICAgICBzdG9yZS5yZW1vdmVJdGVtKGtleSk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh7XG4gICAgICByZXF1ZXN0SWQ6IHRoaXMucmFuZG9tVVVJRCgpLFxuICAgICAgY29tbWFuZDogQ29tbWFuZFR5cGUuUkVNT1ZFLFxuICAgICAgc3RvcmFnZTogc3RvcmFnZSxcbiAgICAgIGtleSxcbiAgICB9KTtcbiAgfVxuXG4gIGRlc3Ryb3koKSB7XG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLmlmcmFtZSk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0VG9rZW4oXG4gICAgc3RvcmFnZTogU3RvcmFnZVR5cGUgPSBTdG9yYWdlVHlwZS5BVVRPTUFUSUMsXG4gICAgZ2VuZXJhdGVWaXNpdG9yVG9rZW46IGFueSB8IG51bGwgPSBudWxsXG4gICkge1xuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgdGhpcy5nZXQoVE9LRU5fS0VZLCBzdG9yYWdlKTtcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIHJldHVybiB0b2tlbjtcbiAgICB9XG4gICAgaWYgKGdlbmVyYXRlVmlzaXRvclRva2VuKSB7XG4gICAgICBkZWJ1Z2dlcjtcbiAgICAgIGNvbnN0IHZpc2l0b3JUb2tlbiA9IGF3YWl0IGdlbmVyYXRlVmlzaXRvclRva2VuKCk7XG4gICAgICBhd2FpdCB0aGlzLnNldFRva2VuKHZpc2l0b3JUb2tlbik7XG4gICAgICByZXR1cm4gdmlzaXRvclRva2VuO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHB1YmxpYyBzZXRUb2tlbih0b2tlbjogc3RyaW5nLCBzdG9yYWdlOiBTdG9yYWdlVHlwZSA9IFN0b3JhZ2VUeXBlLkFVVE9NQVRJQykge1xuICAgIHJldHVybiB0aGlzLnNldCh0b2tlbiwgVE9LRU5fS0VZLCBzdG9yYWdlKTtcbiAgfVxuXG4gIHB1YmxpYyByZW1vdmVUb2tlbihzdG9yYWdlOiBTdG9yYWdlVHlwZSA9IFN0b3JhZ2VUeXBlLkFVVE9NQVRJQykge1xuICAgIHJldHVybiB0aGlzLnJlbW92ZShUT0tFTl9LRVksIHN0b3JhZ2UpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRTdG9yYWdlVHlwZShzdG9yYWdlVHlwZTogU3RvcmFnZVR5cGUpIHtcbiAgICBpZiAoc3RvcmFnZVR5cGUgPT09IFN0b3JhZ2VUeXBlLkFVVE9NQVRJQykge1xuICAgICAgc3RvcmFnZVR5cGUgPVxuICAgICAgICBUT0tFTl9TVE9SQUdFID09PSBcIlNFU1NJT05cIiA/IFN0b3JhZ2VUeXBlLlNFU1NJT04gOiBTdG9yYWdlVHlwZS5MT0NBTDtcbiAgICB9XG4gICAgcmV0dXJuIHN0b3JhZ2VUeXBlO1xuICB9XG5cbiAgLy8g5Y+R6YCB6K+35rGCXG4gIHByaXZhdGUgcmVxdWVzdChyZXE6IFN0b3JhZ2VSZXF1ZXN0KTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIC8vIOebkeWQrOWTjeW6lFxuICAgICAgY29uc3QgaGFuZGxlTWVzc2FnZSA9IChldmVudDogTWVzc2FnZUV2ZW50PFN0b3JhZ2VSZXNwb25zZT4pID0+IHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICF0aGlzLmlmcmFtZU9yaWdpbiB8fFxuICAgICAgICAgIHRoaXM/LmlmcmFtZU9yaWdpbj8uaW5kZXhPZihldmVudC5vcmlnaW4pIDwgMCB8fFxuICAgICAgICAgIGV2ZW50LmRhdGEucmVxdWVzdElkICE9PSByZXEucmVxdWVzdElkXG4gICAgICAgIClcbiAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGhhbmRsZU1lc3NhZ2UpOyAvLyDmuIXnkIbnm5HlkKxcblxuICAgICAgICBpZiAoZXZlbnQuZGF0YS5lcnJvcikge1xuICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoZXZlbnQuZGF0YS5lcnJvcikpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUoZXZlbnQuZGF0YS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgaGFuZGxlTWVzc2FnZSk7XG5cbiAgICAgIGNvbnN0IHNlbmQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwic2VuZCByZXF1ZXN0XCIsIHRoaXMubG9hZGVkKTtcbiAgICAgICAgaWYgKCF0aGlzLmxvYWRlZCkge1xuICAgICAgICAgIHNldFRpbWVvdXQoc2VuZCwgMTAwMCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGhpcy5pZnJhbWUuY29udGVudFdpbmRvdz8ucG9zdE1lc3NhZ2UoXG4gICAgICAgICAgICByZXEsXG4gICAgICAgICAgICB0aGlzLmlmcmFtZU9yaWdpbiBhcyBzdHJpbmdcbiAgICAgICAgICApO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgc2V0VGltZW91dChzZW5kLCAxMDAwKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHNlbmQoKTtcblxuICAgICAgLy8g6LaF5pe25aSE55CGXG4gICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIC8vICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGhhbmRsZU1lc3NhZ2UpO1xuICAgICAgLy8gICByZWplY3QobmV3IEVycm9yKFwiUmVxdWVzdCB0aW1lb3V0XCIpKTtcbiAgICAgIC8vIH0sIDUwMDApO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ29tbWFuZFR5cGUiLCJTdG9yYWdlVHlwZSIsIlNUT1JBR0VfUFJPWFkiLCJUT0tFTl9LRVkiLCJUT0tFTl9TVE9SQUdFIiwiQ3Jvc1N0b3JhZ2UiLCJyYW5kb21VVUlEIiwiaGV4IiwidXVpZCIsImkiLCJpbmNsdWRlcyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImdldEN1cnJlbnRTdG9yYWdlIiwiZ2V0Q3Jvc1N0b3JhZ2UiLCJzZXQiLCJ2YWx1ZSIsImtleSIsInN0b3JhZ2UiLCJBVVRPTUFUSUMiLCJnZXRTdG9yYWdlVHlwZSIsImNyb3MiLCJzdG9yZSIsIkxPQ0FMIiwibG9jYWxTdG9yYWdlIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZXF1ZXN0IiwicmVxdWVzdElkIiwiY29tbWFuZCIsIlNFVCIsImdldCIsImdldEl0ZW0iLCJHRVQiLCJyZW1vdmUiLCJyZW1vdmVJdGVtIiwiUkVNT1ZFIiwiZGVzdHJveSIsImRvY3VtZW50IiwiYm9keSIsInJlbW92ZUNoaWxkIiwiaWZyYW1lIiwiZ2V0VG9rZW4iLCJnZW5lcmF0ZVZpc2l0b3JUb2tlbiIsInRva2VuIiwidmlzaXRvclRva2VuIiwic2V0VG9rZW4iLCJyZW1vdmVUb2tlbiIsInN0b3JhZ2VUeXBlIiwiU0VTU0lPTiIsInJlcSIsInJlamVjdCIsImhhbmRsZU1lc3NhZ2UiLCJldmVudCIsImlmcmFtZU9yaWdpbiIsImluZGV4T2YiLCJvcmlnaW4iLCJkYXRhIiwid2luZG93IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImVycm9yIiwiRXJyb3IiLCJhZGRFdmVudExpc3RlbmVyIiwic2VuZCIsImNvbnNvbGUiLCJsb2ciLCJsb2FkZWQiLCJzZXRUaW1lb3V0IiwiY29udGVudFdpbmRvdyIsInBvc3RNZXNzYWdlIiwiZSIsImNyZWF0ZUVsZW1lbnQiLCJzcmMiLCJzdHlsZSIsImRpc3BsYXkiLCJhcHBlbmRDaGlsZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/common/lib/CrosStorage.ts\n"));

/***/ })

});